import { readFileSync } from "fs";
import { join } from "path";
import {
  GoogleCarouselItem,
  GoogleCarouselScraper,
} from "../scrape-google-carousel";

describe("scrape van gogh paintings", () => {
  let vanGoghPaintingItems: GoogleCarouselItem[];

  beforeAll(() => {
    const vanGoghPaintingsHtml = readFileSync(
      join(__dirname, "../../files/van-gogh-paintings.html"),
      "utf-8"
    );
    const scraper = new GoogleCarouselScraper(vanGoghPaintingsHtml);
    vanGoghPaintingItems = scraper.extractItemsFromHTML();
  });

  it("should extract the correct number of items", () => {
    expect(vanGoghPaintingItems).toHaveLength(51);
  });

  it("should extract the correct attribute value shapes", () => {
    for (const { name, extensions, link, image } of vanGoghPaintingItems) {
      expect(name).not.toBeEmpty();
      expect(extensions).toBeArray();
      expect(link).toMatch(/^https:\/\/www.google.com\/search?.+/);
      expect(image).toBeOneOf([
        null,
        expect.stringMatching(String.raw`^data:image.+`),
      ]);
    }
  });

  it("should extract paintings with an image correctly", () => {
    const paintingA = vanGoghPaintingItems[0];
    expect(paintingA.name).toStrictEqual("The Starry Night");
    expect(paintingA.extensions).toStrictEqual(["1889"]);
    expect(paintingA.link).toStrictEqual(
      "https://www.google.com/search?gl=us&hl=en&q=The+Starry+Night&stick=H4sIAAAAAAAAAONgFuLQz9U3MI_PNVLiBLFMzC3jC7WUspOt9Msyi0sTc-ITi0qQmJnFJVbl-UXZxY8YI7kFXv64JywVMGnNyWuMXlxEaBJS4WJzzSvJLKkUkuLikYLbrcEgxcUF5_EsYhUIyUhVCC5JLCqqVPDLTM8oAQDmNFnDqgAAAA&npsic=0&sa=X&ved=0ahUKEwiL2_Hon4_hAhXNZt4KHTOAACwQ-BYILw"
    );
    expect(paintingA.image).toStrictEqual(
      "data:image/jpeg;base64,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"
    );

    const paintingB = vanGoghPaintingItems[5];
    expect(paintingB.name).toStrictEqual("The Potato Eaters");
    expect(paintingB.extensions).toStrictEqual(["1885"]);
    expect(paintingB.link).toStrictEqual(
      "https://www.google.com/search?gl=us&hl=en&q=The+Potato+Eaters&stick=H4sIAAAAAAAAAONgFuLQz9U3MI_PNVLiBLFMTCxMKrWUspOt9Msyi0sTc-ITi0qQmJnFJVbl-UXZxY8YI7kFXv64JywVMGnNyWuMXlxEaBJS4WJzzSvJLKkUkuLikYLbrcEgxcUF5_EsYhUMyUhVCMgvSSzJV3BNLEktKgYAoS92w6sAAAA&npsic=0&sa=X&ved=0ahUKEwiL2_Hon4_hAhXNZt4KHTOAACwQ-BYIPg"
    );
    expect(paintingB.image).toStrictEqual(
      "data:image/jpeg;base64,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"
    );
  });

  it("should extract paintings without an image correctly", () => {
    const paintingA = vanGoghPaintingItems[vanGoghPaintingItems.length - 1];
    expect(paintingA.name).toStrictEqual("Portrait of Adeline Ravoux");
    expect(paintingA.extensions).toStrictEqual(["1890"]);
    expect(paintingA.link).toStrictEqual(
      "https://www.google.com/search?gl=us&hl=en&q=Portrait+of+Adeline+Ravoux&stick=H4sIAAAAAAAAAONgFuLQz9U3MI_PNVLi1k_XNzQyyjYzTq7SUspOttIvyywuTcyJTywqQWJmFpdYlecXZRc_YozkFnj5456wVMCkNSevMXpxEaFJSIWLzTWvJLOkUkiKi0cKbrsGgxQXF5zHs4hVKiC_qKQoMbNEIT9NwTElNSczL1UhKLEsv7QCAOSAHzG2AAAA&npsic=0&sa=X&ved=0ahUKEwiL2_Hon4_hAhXNZt4KHTOAACwQ-BYIxQE"
    );
    expect(paintingA.image).toBeNull();

    const paintingB = vanGoghPaintingItems[47];
    expect(paintingB.name).toStrictEqual("La Mousmé");
    expect(paintingB.extensions).toStrictEqual(["1888"]);
    expect(paintingB.link).toStrictEqual(
      "https://www.google.com/search?gl=us&hl=en&q=La+Mousm%C3%A9&stick=H4sIAAAAAAAAAONgFuLQz9U3MI_PNVLiArFMk6uMiuK1lLKTrfTLMotLE3PiE4tKkJiZxSVW5flF2cWPGCO5BV7-uCcsFTBpzclrjF5cRGgSUuFic80rySypFJLi4pGCW67BIMXFBefxLGLl8klU8M0vLc49vBIAbt_trKUAAAA&npsic=0&sa=X&ved=0ahUKEwiL2_Hon4_hAhXNZt4KHTOAACwQ-BYIvAE"
    );
    expect(paintingB.image).toBeNull();
  });
});

describe("scrape leonardo da vinci art", () => {
  let leonardoDaVinciArtwork: GoogleCarouselItem[];

  beforeAll(() => {
    const leonardoDaVinciArtworkHtml = readFileSync(
      join(__dirname, "../../files/leonardo-da-vinci-art.html"),
      "utf-8"
    );
    const scraper = new GoogleCarouselScraper(leonardoDaVinciArtworkHtml);
    leonardoDaVinciArtwork = scraper.extractItemsFromHTML();
  });

  it("should extract the correct number of items", () => {
    expect(leonardoDaVinciArtwork).toHaveLength(50);
  });

  it("should extract the correct attribute value shapes", () => {
    for (const { name, extensions, link, image } of leonardoDaVinciArtwork) {
      expect(name).not.toBeEmpty();
      expect(extensions).toBeArray();
      expect(link).toMatch(/^https:\/\/www.google.com\/search?.+/);
      expect(image).toBeOneOf([
        null,
        expect.stringMatching(String.raw`^data:image.+`),
        expect.stringMatching(
          String.raw`^https://encrypted-tbn0.gstatic.com/.+`
        ),
      ]);
    }
  });

  it("should extract paintings that are not hidden off-screen correctly", () => {
    const paintingA = leonardoDaVinciArtwork[0];
    expect(paintingA.name).toStrictEqual("Mona Lisa");
    expect(paintingA.extensions).toStrictEqual(["1503"]);
    expect(paintingA.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZsbXGm7RIxXXh5T3Q4HhxZ6-ARRw:1660268305198&q=Mona+Lisa&stick=H4sIAAAAAAAAAONgFuLQz9U3MMlJN1MCs7KS0o20lLKTrfTLMotLE3PiE4tKkJiZxSVW5flF2cWPGLuZuAVe_rgnLNXINGnNyWuMvxi5iNAnpMPF5ppXkllSKcQjxcUFt91IhItXP13f0DCroDC-qMQkV-DCkumMSnMZjeJ2XZp2ji1C0KmCgaHrRoiDlIaWIBebS35uYmae4KNk-YZ1_9_bawlzcYQkVuTn5edWCppofN7_HSiopMjpZXxmv8-r9_aC_Y8YFFxFrRwkWBQYNBgMH1myOqyfwnhAi-EAI9MjRk1inC7K7vLYvWnfikNsHByMAgxGTBwMVkwajFVMHMw8i1g5ffPzEhV8MosTJ7AxAgCSj4h2WAEAAA&sa=X&ved=2ahUKEwilncC0lcD5AhWexXMBHQFJABUQ-BZ6BAgrEA4"
    );
    expect(paintingA.image).toStrictEqual(
      "data:image/jpeg;base64,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"
    );

    const paintingB = leonardoDaVinciArtwork[5];
    expect(paintingB.name).toStrictEqual("Virgin of the Rocks");
    expect(paintingB.extensions).toStrictEqual([""]);
    expect(paintingB.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZsbXGm7RIxXXh5T3Q4HhxZ6-ARRw:1660268305198&q=Virgin+of+the+Rocks&stick=H4sIAAAAAAAAAONgFuLQz9U3MMlJN1Pi0U_XNyw2MM0rLkvK0lLKTrbSL8ssLk3MiU8sKkFiZhaXWJXnF2UXP2LsZuIWePnjnrBUI9OkNSevMf5i5CJCn5AOF5trXklmSaUQjxQXF9wFRiJcvCA3GGYVFMYXlZjkClxYMp1RaS6jUdyuS9POsUUIOlUwMHTdCHGQ0tAS5GJzyc9NzMwTfJQs37Du_3t7LWEujpDEivy8_NxKQRONz_u_AwWVFDm9jM_s93n13l6w_xGDgquolYMEiwKDBoPhI0tWh_VTGA9oMRxgZHrEqEmM00XZXR67N-1bcYiNg4NRgMGIiYPBikmDsYqJg5lnEatwWGZRemaeQn6aQklGqkJQfnJ28QQ2RgDhqmqhZgEAAA&sa=X&ved=2ahUKEwilncC0lcD5AhWexXMBHQFJABUQ-BZ6BAgrEB0"
    );
    expect(paintingB.image).toStrictEqual(
      "data:image/jpeg;base64,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"
    );
  });

  it("should extract paintings that are hidden off-screen correctly", () => {
    const paintingA = leonardoDaVinciArtwork["13"];
    expect(paintingA.name).toStrictEqual("Saint Jerome in the Wilderness");
    expect(paintingA.extensions).toStrictEqual(["1480"]);
    expect(paintingA.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZsbXGm7RIxXXh5T3Q4HhxZ6-ARRw:1660268305198&q=Saint+Jerome+in+the+Wilderness&stick=H4sIAAAAAAAAAONgFuLQz9U3MMlJN1PiArGMU4xN4g20lLKTrfTLMotLE3PiE4tKkJiZxSVW5flF2cWPGLuZuAVe_rgnLNXINGnNyWuMvxi5iNAnpMPF5ppXkllSKcQjxcUFt99IhItXP13f0DCroDC-qMQkV-DCkumMSnMZjeJ2XZp2ji1C0KmCgaHrRoiDlIaWIBebS35uYmae4KNk-YZ1_9_bawlzcYQkVuTn5edWCppofN7_HSiopMjpZXxmv8-r9_aC_Y8YFFxFrRwkWBQYNBgMH1myOqyfwnhAi-EAI9MjRk1inC7K7vLYvWnfikNsHByMAgxGTBwMVkwajFVMHMw8i1jlgoHuKVHwSi3Kz01VyMxTKMlIVQjPzElJLcpLLS6ewMYIACHZQoVvAQAA&sa=X&ved=2ahUKEwilncC0lcD5AhWexXMBHQFJABUQ-BZ6BAgrEDU"
    );
    expect(paintingA.image).toStrictEqual(
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTSViu6Ce8LQ4BHszqZgbe-4p0pMq1h3BUC98bIsexl_yCtXc_RDj42&s=0"
    );

    const paintingB = leonardoDaVinciArtwork["26"];
    expect(paintingB.name).toStrictEqual("Profile of an ancient captain");
    expect(paintingB.extensions).toStrictEqual(["1472"]);
    expect(paintingB.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZsbXGm7RIxXXh5T3Q4HhxZ6-ARRw:1660268305198&q=Profile+of+an+ancient+captain&stick=H4sIAAAAAAAAAONgFuLQz9U3MMlJN1Pi1k_XNzQyNM5Kik_SUspOttIvyywuTcyJTywqQWJmFpdYlecXZRc_Yuxm4hZ4-eOesFQj06Q1J68x_mLkIkKfkA4Xm2teSWZJpRCPFBcX3AFGIly8ICcYZhUUxheVmOQKXFgynVFpLqNR3K5L086xRQg6VTAwdN0IcZDS0BLkYnPJz03MzBN8lCzfsO7_e3stYS6OkMSK_Lz83EpBE43P-78DBZUUOb2Mz-z3efXeXrD_EYOCq6iVgwSLAoMGg-EjS1aH9VMYD2gxHGBkesSoSYzTRdldHrs37VtxiI2Dg1GAwYiJg8GKSYOxiomDmWcRq2xAUX5aZk6qQn6aQmIeECVnpuaVKCQnFpQAHTqBjREAW1Ba1G8BAAA&sa=X&ved=2ahUKEwilncC0lcD5AhWexXMBHQFJABUQ-BZ6BAgrEFw"
    );
    expect(paintingB.image).toStrictEqual(
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTgSDdxgte17H-iodMN-limDmy5aPXwk_2nA2gCEvpyO3XrwDbsNgZ2&s=0"
    );
  });
});

describe("scrape top cyclists", () => {
  let topCyclists: GoogleCarouselItem[];

  beforeAll(() => {
    const topCyclistsHtml = readFileSync(
      join(__dirname, "../../files/top-cyclists.html"),
      "utf-8"
    );
    const scraper = new GoogleCarouselScraper(topCyclistsHtml);
    topCyclists = scraper.extractItemsFromHTML();
  });

  it("should extract the correct number of items", () => {
    expect(topCyclists).toHaveLength(27);
  });

  it("should extract the correct attribute value shapes", () => {
    for (const { name, extensions, link, image } of topCyclists) {
      expect(name).not.toBeEmpty();
      expect(extensions).toBeArray();
      expect(link).toMatch(/^https:\/\/www.google.com\/search?.+/);
      expect(image).toBeOneOf([
        null,
        expect.stringMatching(String.raw`^data:image.+`),
        expect.stringMatching(
          String.raw`^https://encrypted-tbn0.gstatic.com/.+`
        ),
      ]);
    }
  });

  it("should extract cyclists that are not hidden off-screen correctly", () => {
    const cyclistA = topCyclists[0];
    expect(cyclistA.name).toStrictEqual("Chris Froome");
    expect(cyclistA.extensions).toStrictEqual(["Israel–Premier Tech"]);
    expect(cyclistA.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZSsy7fNRFa4Cb6KLFoVEIFt4Ozxw:1660269329548&q=Chris+Froome&stick=H4sIAAAAAAAAAE2RvU7DMBSFFURR60YIha1TATHnr0naDbUSW4UQrKgiTuKkcWLHsZI4T4F4BGZehD4AIwMbb8AIlWzEds49915_Vx4OzoFZmNYsYPaicHRO6BQKiLOa1zvtXyRNmEIHNTtttDd-2_ZIapQXuS01dMpqKwcc2kA8k0HqNa4lA5SgNlJvoG3k9p00aTmnVS5H5rBsoQyCPNr4rery55bfSOMigTpfoYiFp3g9GuCFkEFUVFSxe8ziam_IRJggBRw4pQiUaTueKhS36t1QYVE7raS2Yen_rhruNW07pm7yKorVtbmLo9z61PD45Ov743QCn1_f3rUHcLiMa27cgvFdzO_JmkRZIoylcQVG67gIY1bfJIYLwIpgHEOekdK4nFyAMxP-FUyCRUEzuGHkMdqov-sPhsf6y0BfpSyrp9eMkCJ-OtJ-AAFSqbfvAQAA&sa=X&ved=2ahUKEwi51vmcmcD5AhXk_XMBHWICCpEQ-BZ6BAgcEAU"
    );
    expect(cyclistA.image).toStrictEqual(
      "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QDLRXhpZgAASUkqAAgAAAABAA4BAgCpAAAAGgAAAAAAAABXSU5EU09SLCBFTkdMQU5EIC0gIFVOREFURUQ6IENocmlzIEZyb29tZSBvZiBUZWFtIFNreSBwb3NlcyBmb3IgYSBwb3J0cmFpdCBzZXNzaW9uIGFoZWFkIG9mIHRoZSAyMDExIHJvYWQgc2Vhc29uIGluIFdpbmRzb3IsIEVuZ2xhbmQuIChQaG90byBieSBCcnluIExlbm5vbi9HZXR0eSBJbWFnZXMp/+0A7FBob3Rvc2hvcCAzLjAAOEJJTQQEAAAAAADPHAJQAAtCcnluIExlbm5vbhwCeACpV0lORFNPUiwgRU5HTEFORCAtICBVTkRBVEVEOiBDaHJpcyBGcm9vbWUgb2YgVGVhbSBTa3kgcG9zZXMgZm9yIGEgcG9ydHJhaXQgc2Vzc2lvbiBhaGVhZCBvZiB0aGUgMjAxMSByb2FkIHNlYXNvbiBpbiBXaW5kc29yLCBFbmdsYW5kLiAoUGhvdG8gYnkgQnJ5biBMZW5ub24vR2V0dHkgSW1hZ2VzKRwCbgAMR2V0dHkgSW1hZ2VzAP/hA4BodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvAAk8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgoJCTxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6SXB0YzR4bXBDb3JlPSJodHRwOi8vaXB0Yy5vcmcvc3RkL0lwdGM0eG1wQ29yZS8xLjAveG1sbnMvIiB4bWxuczpHZXR0eUltYWdlc0dJRlQ9Imh0dHA6Ly94bXAuZ2V0dHlpbWFnZXMuY29tL2dpZnQvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwbHVzPSJodHRwOi8vbnMudXNlcGx1cy5vcmcvbGRmL3htcC8xLjAvIiB4bWxuczppcHRjRXh0PSJodHRwOi8vaXB0Yy5vcmcvc3RkL0lwdGM0eG1wRXh0LzIwMDgtMDItMjkvIiBwaG90b3Nob3A6Q3JlZGl0PSJHZXR0eSBJbWFnZXMiIEdldHR5SW1hZ2VzR0lGVDpBc3NldElEPSIxMTE4MDMxMzkiID4KPGRjOmNyZWF0b3I+PHJkZjpTZXE+PHJkZjpsaT5CcnluIExlbm5vbjwvcmRmOmxpPjwvcmRmOlNlcT48L2RjOmNyZWF0b3I+PGRjOmRlc2NyaXB0aW9uPjxyZGY6QWx0PjxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+V0lORFNPUiwgRU5HTEFORCAtICBVTkRBVEVEOiBDaHJpcyBGcm9vbWUgb2YgVGVhbSBTa3kgcG9zZXMgZm9yIGEgcG9ydHJhaXQgc2Vzc2lvbiBhaGVhZCBvZiB0aGUgMjAxMSByb2FkIHNlYXNvbiBpbiBXaW5kc29yLCBFbmdsYW5kLiAoUGhvdG8gYnkgQnJ5biBMZW5ub24vR2V0dHkgSW1hZ2VzKTwvcmRmOmxpPjwvcmRmOkFsdD48L2RjOmRlc2NyaXB0aW9uPgoJCTwvcmRmOkRlc2NyaXB0aW9uPgoJPC9yZGY6UkRGPgr/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAHgAeAMBIgACEQEDEQH/xAAbAAABBAMAAAAAAAAAAAAAAAACAAEDBgQFB//EADUQAAEEAQMCAwUHAwUAAAAAAAEAAgMRBAUSIQYxE0FRIjJhcYEUI0JSkbHBBzPhFUNyobL/xAAaAQACAwEBAAAAAAAAAAAAAAABBQADBAIG/8QAJREAAgICAgICAgMBAAAAAAAAAAECEQMhBBIxUQUTIvBBYXEy/9oADAMBAAIRAxEAPwDje1PSKk9LVRlsGkqRJ0aBYNJUipKkaJY1JUipLa66AJPoEAAEJUpHxvZW9pb80KgQaTIqSpCiWDSYhHSYhSg2BSSKkkA2SbU9IqT0raKrApLapAE+1SgWR0mdw26P0UoaSQB3KsfSnT02fP4+RHtiHLXOHu/Ieqqy5FjjZdhxvLKkV1uJkloLsf2TyCR/CzMfEy5XjafCG3Y5/IXXsHpzBc1niRmTb5u81PN0bgPcZMeWSB59ACEsedyexquL1WjkbsGaAlz8hpZXZo3X/lYGbitj9pocHfiaR/2F1fL6IJmBZM3YPICm/OvX4qudRdLTYkQe0l8LQd202eysxZ6kV5eM3E5/SalI9u1xCGkyVNWhU9OmAkjQkKEsGkk9J0KCTbU9I6T0raKbApKkdJUpQLJMGMvy4mj8y69o+OPBa1jaaKAXMemYTPrMTAOG+0V2HR2BsIDhSV82X50O/jYfh2NtiRU0Cvms5kVt5tRQjtTVnMFN81lSGEpGDLHwQtNqWP4jS2lv5QbNBYOUAAQ4c0gwrZw7rPRjgaj9qhH3GR3A/A7zCrtLqfWELThSNe22Hgmvd+K5eW0SPRM+JPtCvQi5uPpkv2R0mUhCGlqMlgJ05CZAJmbUqR0lSuoz2BSVI6U2FE2bNx4pDTHyta4/AkAoPSsK26Nl0e/w9Uk/4D+V0KLVpQ7w8XHdJtPtEcWfQKvTYj8XWoYpsOHHcAWb4W7RI2+CR6gcK5P0CPIx42smkibQ/tgJHnmpz7ez0nHxyxR6X4IYOsc7De0ZmkStjPZ57fqrNia23LxRPHGQCLI70q/g9IY+K+Z8uVlziT3RK4kRc3x6/W/2W60pkWPBMyKgwni1W7Wky6KvbRptV6szYZfCwsaOY9j8D8zwsWbWdUcD9sxGtd32seHfrytxNomJnwlvhuBLS12x9HnzHxWJjdJQYpDvGzZCCT99Nuu/2+lIeVsjtS0VTXsoZGnTkgj2eQfJc1ka5rjuaWk80RXBXW+rsaOMiNrS4SCiB3KpPX2PkQ6zA7KIL5cZr6aKDPacNo+VLbw5U+vsXfIY249/RV0JCkpCQmIqTApMjpJANmbSVI6SpaDLYNJqPlwfVHSVIEs6H1dl+Lp2k6tE0lr3h8jq7buVcdIyxJjxndYLQuRYutuh0LJ0mePxYZDcZ3f2zd/p5rofS+8Y2HzbXsFFIuRheJ0z1PE5Mc+163/pc8mWKLAlnfwGMLj9FUsPqTSImZUGRkgTRWTZpbrJz4tv2eQNdvbRY4d2n1HohxsLSbbIcXDa5vYuDQWqlbNVNKwemdYxM1zhA5720XW5jmmrHqORyttnSDYdnb1WmkzsLEncYpcZnk4tc21lZL3HEe4cCrA7d0G60Hruyqam92d1Hp+NGLO/e4fJU/8AqdmR5fVLhF2ghbG6vIkl37OC2eqa8/QdXM8ULJpXROYNziNt+ao2TNJlZEuRMbkleXuPxJtMOHif/b8Cf5HPGnjXmyCkxCMhCUwFKYFJIiElyGzPpPSOkqWmjJYBaltR0moqUSwC1XzofWBJpscTjb8V9fQKjELYYbcnRJsfUY2l2LkD2x6OS75CKcUNfipuM5ejr2s4OFremhskDJBW5jhw5nrRHIWoxOm9NxY2g4rpbN2+3n/0E3SWvYuXG6JkoDh+E9wrZHJGyw4NI8kqVrR6KMl1NBpnT+n4ua3IbhR+I0lzXPaCWntx6LM1zNbHE4E0Giz8Vl5ufj4sT5pZGMa0ckmly/XOocjWsh+HpQJ8R1eJ6D1UpyOck0ita5k/bNSlkuxdBa/atjrGD/p2acb8jG2T8lhEJ7gS+qNHluTJ/dK/ZEWoSFKQhIVjRUmREJIiE65o6s2QalSl2pbFrowdiKvgnoKXYmftjaXyOaxo7lxoIUSyEtXStH0mLN6djxJmh3s1f8hclzNTZK18WE4ucAbfXl8Fe/6f65n6ZpkDdaxJG6c6LxIM3gtazeGe1R49pzQL55HzS7mJZkow8oc/HN4G55Fp/tmDn9L52Lmb9PkcyVp4INWshmm9Zyjl0x+O4BX/ACo2TPZkQua+N44e02Fk42e+GExubyDTXeSV3JOmh5HGpK4vRzCXp7X8p4i1CeTZful/CvHTXTOPpmL4mwOlcPeK2rIn5ErXP5s2oOp+pNO6exCcuUGWvYhabc4oxjPK+sUczljwrtJnNeu4CzXXSfhewV9FXdqLUtYzNVzJtWymBuO5wY1l+6Oew8+xv/Bp4ZIp2b4Xh7fh5J1g6qCgn4PN8ru8jm15IyEBCyCxAWq1ooUiAhJSFqS5o77G12pzTGF7yGtHcnyTJLTOXSDkY8UfsyKL/kwZ9RbRbjts/ncP4Wh1LxZJR4sr3gi2hzrpOklOTNPJ5Y/xcbHiX4oix2GOQPstNdu/6q76H1TFHp8Wmajp2DLihhja90Xuj3gXNsB4DxG6jV067LrSSXCLWZ+pa5F0pnxw6S+Sdk332Xh+I10GJuAPgxuF7i07rN1W0d7Wcz+pmnfcbsSVm5x8Xf8A7Qvg+d8c8J0l1N9kuys5xp423BtX++P3+zHd17qGuZ0Om6FC3GlnO3xZztaz48cqvalhYmFnzyavlv1PLa4US4CLloNGieQSeBY4/V0lw8snPotL0jTHjY48b7nuTlVt3qjSavmy6i9zgGtHO1jW7WsB8mjy8u/oB2ArUs8SGTdG4sePMJJLrxso86NziZsrmD7S1vzbwVmgteLYQQkktODLKUurMHK48IR7x0C5qSSS0mFM/9kx3d"
    );

    const cyclistB = topCyclists[6];
    expect(cyclistB.name).toStrictEqual("Marianne Vos");
    expect(cyclistB.extensions).toStrictEqual([""]);
    expect(cyclistB.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZSsy7fNRFa4Cb6KLFoVEIFt4Ozxw:1660269329548&q=Marianne+Vos&stick=H4sIAAAAAAAAAD2RvU7DMBSFFURRm1YIha1TATHnx03SblWZK4RAbKhqnMRJ49iOEyVxngLxCMy8CH0ARgY23oARWtls5_j43vtd3X7vcmDmppW4NbCcUUXZBAqI07Iqd5q-T6Y-t-e5NEECHVTvtEON1zQdkhpleWZLDR1SbGWBw2qIpzI4DJEBilETqhloG4KulSYhM1ZksmQGSQNl4Gfh2mvUL29mebU0AAnUegpFzF3F6zIfz4UMwrxgit3lVqX6BlwEMVLAvkOEr0zTVolCAUUHAoXF7KSQ2obE-2vV32vWtFzt5BYMq20zgMPM-tLw8Oz75_N8DF_e3j-0J_14GZWVcacP76Pqga5omMbCWBoLfbCK8iDi5W1sAF2_oRhHsEopMa7HV_qFCf8fTIpFzlK45nQTrtXtuqP-6ei1N1pteLohJJo80vL5RPsFE3sfEO4BAAA&sa=X&ved=2ahUKEwi51vmcmcD5AhXk_XMBHWICCpEQ-BZ6BAgcEBc"
    );
    expect(cyclistB.image).toStrictEqual(
      "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QGiRXhpZgAASUkqAAgAAAABAA4BAgCAAQAAGgAAAAAAAABQQVJJUywgRlJBTkNFIC0gSlVMWSAyNzogIE1hcmlhbm5lIFZvcyBvZiB0aGUgTmV0aGVybGFuZHMgYW5kIHRoZSBSYWJvYmFuay1MaXYgd29tZW4ncyB0ZWFtIHByZXBhcmVzIHRvIHJpZGUgJ0xhIENvdXJzZScgYnkgTGUgVG91ciBkZSBGcmFuY2Ugb24gSnVseSAyNywgMjAxNCBpbiBQYXJpcywgRnJhbmNlLiBJbiB0aGlzIGhpc3RvcmljIGZpcnN0IGVkaXRpb24gb2YgdGhlIGV2ZW50LCBmZW1hbGUgcHJvZmVzc2lvbmFsIHJpZGVycyB3aWxsIHJhY2UgOTBrbSBvbiB0aGUgQ2hhbXBzIEVseXNlZXMgcHJpb3IgdG8gdGhlIGFycml2YWwgb2YgdGhlIE1lbidzIFRvdXIgZGUgRnJhbmNlIGZpbmFsIHN0YWdlLiAgKFBob3RvIGJ5IEJyeW4gTGVubm9uL0dldHR5IEltYWdlcyn/7QHCUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAaYcAlAAC0JyeW4gTGVubm9uHAJ4AYBQQVJJUywgRlJBTkNFIC0gSlVMWSAyNzogIE1hcmlhbm5lIFZvcyBvZiB0aGUgTmV0aGVybGFuZHMgYW5kIHRoZSBSYWJvYmFuay1MaXYgd29tZW4ncyB0ZWFtIHByZXBhcmVzIHRvIHJpZGUgJ0xhIENvdXJzZScgYnkgTGUgVG91ciBkZSBGcmFuY2Ugb24gSnVseSAyNywgMjAxNCBpbiBQYXJpcywgRnJhbmNlLiBJbiB0aGlzIGhpc3RvcmljIGZpcnN0IGVkaXRpb24gb2YgdGhlIGV2ZW50LCBmZW1hbGUgcHJvZmVzc2lvbmFsIHJpZGVycyB3aWxsIHJhY2UgOTBrbSBvbiB0aGUgQ2hhbXBzIEVseXNlZXMgcHJpb3IgdG8gdGhlIGFycml2YWwgb2YgdGhlIE1lbidzIFRvdXIgZGUgRnJhbmNlIGZpbmFsIHN0YWdlLiAgKFBob3RvIGJ5IEJyeW4gTGVubm9uL0dldHR5IEltYWdlcykcAm4ADEdldHR5IEltYWdlc//hBGtodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvAAk8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgoJCTxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6SXB0YzR4bXBDb3JlPSJodHRwOi8vaXB0Yy5vcmcvc3RkL0lwdGM0eG1wQ29yZS8xLjAveG1sbnMvIiB4bWxuczpHZXR0eUltYWdlc0dJRlQ9Imh0dHA6Ly94bXAuZ2V0dHlpbWFnZXMuY29tL2dpZnQvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwbHVzPSJodHRwOi8vbnMudXNlcGx1cy5vcmcvbGRmL3htcC8xLjAvIiB4bWxuczppcHRjRXh0PSJodHRwOi8vaXB0Yy5vcmcvc3RkL0lwdGM0eG1wRXh0LzIwMDgtMDItMjkvIiBwaG90b3Nob3A6Q3JlZGl0PSJHZXR0eSBJbWFnZXMiIEdldHR5SW1hZ2VzR0lGVDpBc3NldElEPSI0NTMyMDI1NTIiID4KPGRjOmNyZWF0b3I+PHJkZjpTZXE+PHJkZjpsaT5CcnluIExlbm5vbjwvcmRmOmxpPjwvcmRmOlNlcT48L2RjOmNyZWF0b3I+PGRjOmRlc2NyaXB0aW9uPjxyZGY6QWx0PjxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+UEFSSVMsIEZSQU5DRSAtIEpVTFkgMjc6ICBNYXJpYW5uZSBWb3Mgb2YgdGhlIE5ldGhlcmxhbmRzIGFuZCB0aGUgUmFib2JhbmstTGl2IHdvbWVuJmFwb3M7cyB0ZWFtIHByZXBhcmVzIHRvIHJpZGUgJmFwb3M7TGEgQ291cnNlJmFwb3M7IGJ5IExlIFRvdXIgZGUgRnJhbmNlIG9uIEp1bHkgMjcsIDIwMTQgaW4gUGFyaXMsIEZyYW5jZS4gSW4gdGhpcyBoaXN0b3JpYyBmaXJzdCBlZGl0aW9uIG9mIHRoZSBldmVudCwgZmVtYWxlIHByb2Zl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"
    );
  });

  it("should extract cyclists that are hidden off-screen correctly", () => {
    const cyclistA = topCyclists[topCyclists.length - 1];
    expect(cyclistA.name).toStrictEqual("Amanda Spratt");
    expect(cyclistA.extensions).toStrictEqual([""]);
    expect(cyclistA.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZSsy7fNRFa4Cb6KLFoVEIFt4Ozxw:1660269329548&q=Amanda+Spratt&stick=H4sIAAAAAAAAAD2RvU7DMBSFFURRmxaEwtapgJjz4yZpt1LmCqGyoiqxEyeNkziJlcR5CsQjMPMi9AEYGdh4A0Yo2Gzn-Pje-12737tQ9VQ3EkBQYlgjltMJ5JDEFat2ym80dUtzngrjR9DC9U4Z7I3TNB0WGidpYgoNrazYigKL1pBMRRDZNTBEgEPcIDkDbxHoWmGibEaLRJTMYNZAEbgJ2jiNvOXMDKcWBmCOW0ei8LkteW3qkjkXAUoLKtnt0mCyr19yP8QS2LUy7krTtCySKKDogC-xqBkVQpswc35a9feaNm0pd7ILSuS2f-_7oZDh6efX-9kYPr28vikP6uEyqJh2pw7XAbvPVzmKQ64ttYU6WAWpH5TVbagBVb3JCQkgi_NMuxpfquc6_D_Qc8JTGsNNmXtoI_-uO-ifjJ57x9eplyFvsqalx9jjkfINrdi54fABAAA&sa=X&ved=2ahUKEwi51vmcmcD5AhXk_XMBHWICCpEQ-BZ6BAgcEFM"
    );
    expect(cyclistA.image).toStrictEqual(
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQjjYJOEYW77O6FImc0y_SOIyVGnDlLHfzqXUmIPICErtTgP0SLAC8C&s=0"
    );

    const cyclistB = topCyclists[22];
    expect(cyclistB.name).toStrictEqual("Fabian Cancellara");
    expect(cyclistB.extensions).toStrictEqual([""]);
    expect(cyclistB.link).toStrictEqual(
      "https://www.google.com/search?sxsrf=ALiCzsZSsy7fNRFa4Cb6KLFoVEIFt4Ozxw:1660269329548&q=Fabian+Cancellara&stick=H4sIAAAAAAAAAD2RvU7DMBSFFURR61YIwtapgJjz1_x0Q63EViEEK6oSJ3HSOI6TWEmcp0A8AjMvQh-AkYGNN2CEIpvtHB_fe79rDwcXIy3XdI8aSWlOWEFnkEOc1qzeKWCfzN3KWOTCBAk0UbNT_mqctu2R0CjLM0NoaJJyKwpM2kA8F0FiN5YuAhSjNpQz0Da0-k6YhHi0zESJB0kLReBm4cZp5S3H051GGAtx1DkShS9syWtTFy-4CMK8pJLdrnQm-wYVD2IkgV2TcFeatmOJRLHK3gok1v65hDYgcX5bDfeatl0ld7JLiuW2mYXDTP9U8Pjk6_vjbAqfX9_elUdwuIxqpt6B8X3EHop1EaYxV5fqNRitozyIqvo2Vi0AVgXGEWRpQdSr6SU41-D_gVZgntMUbqrCDzfy7_qD4fHkZXB64wepT2Yrn8AIY7_yn46UH3s6_-zzAQAA&sa=X&ved=2ahUKEwi51vmcmcD5AhXk_XMBHWICCpEQ-BZ6BAgcEEc"
    );
    expect(cyclistB.image).toStrictEqual(
      "https://encrypted-tbn0.gstatic.com/licensed-image?q=tbn:ANd9GcRRfZU5umaT-GzlzRDYoaip3EkQglcl3KSJoheyVWlGsPQbROziWLICu2vsrEST_E_rBCkCl7o&s=19"
    );
  });
});
